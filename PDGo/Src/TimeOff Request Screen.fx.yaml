"'TimeOff Request Screen' As screen":
    OnVisible: |-
        =If(IsBlankOrError(RequestDates),ClearCollect(RequestDates, {
            StartDate: Today(),
            EndDate: Today(),
            Reason: "VCN",
            EntireDay: true,
            StartTime: "9:00", // 9-5, because why not
            EndTime: "17:00"
        }))

    "'TO Request Screen Main Container' As groupContainer.verticalAutoLayoutContainer":
        Height: =Parent.Height
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGap: =10
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        PaddingBottom: =20
        PaddingLeft: =20
        PaddingRight: =20
        PaddingTop: =20
        Width: =Parent.Width
        ZIndex: =1

        Header As groupContainer.horizontalAutoLayoutContainer:
            Fill: =RGBA(136, 160, 209, 1)
            FillPortions: =0
            Height: =75
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutJustifyContent: =LayoutJustifyContent.Center
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            ZIndex: =1

            Icon2 As icon.ArrowLeft:
                Icon: =Icon.ArrowLeft
                Width: =50
                ZIndex: =1

            Label11 As label:
                Align: =Align.Center
                FillPortions: =1
                Size: =20
                Text: ="Requests"
                ZIndex: =2

            Image1 As image:
                Image: =User().Image
                ImagePosition: =ImagePosition.Fill
                LayoutMinHeight: =75
                ZIndex: =3

            Label21 As label:
                Size: =15
                Text: ="Hello, " & User().FullName
                Visible: ='TimeOff Request Screen'.Size<>1
                ZIndex: =4

        Container6 As groupContainer.verticalAutoLayoutContainer:
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =100
            LayoutMinWidth: |+
                ='TO Request Screen Main Container'.Width*.96
                
                
            LayoutMode: =LayoutMode.Auto
            ZIndex: =2

            "'TO Request Screen Date List' As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                DelayItemLoading: =true
                Items: =RequestDates
                Layout: =Layout.Vertical
                LayoutMinHeight: =287
                LayoutMinWidth: =320
                LoadingSpinner: =LoadingSpinner.Data
                TemplateSize: =104
                X: =60
                Y: =60
                ZIndex: =1

                "'TO Request Screen Date List Container' As groupContainer.horizontalAutoLayoutContainer":
                    Height: =Parent.TemplateHeight
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMode: =LayoutMode.Auto
                    LayoutWrap: =true
                    Width: |+
                        ='TO Request Screen Date List'.TemplateWidth
                        
                    ZIndex: =8

                    "'TO Date Screen Date List Date Range' As label":
                        Align: =Align.Center
                        Text: =ThisItem.StartDate & "-" & ThisItem.EndDate
                        Width: |
                            ='TO Request Screen Date List Container'.Width * 0.2
                        ZIndex: =1

                    "'TO Date Screen Date List Leave Reason' As label":
                        Text: =ThisItem.Reason
                        Width: |
                            ='TO Request Screen Date List Container'.Width * 0.2
                        ZIndex: =2

                    "'TO Date Screen Date List Time Range' As label":
                        Align: =Align.Center
                        LayoutMinWidth: =100
                        Text: =If(ThisItem.EntireDay, "Entire Day", ThisItem.StartTime & "-" & ThisItem.EndTime)
                        Width: |
                            ='TO Request Screen Date List Container'.Width * 0.2
                        ZIndex: =3

                    "'TO Date Screen Date List Item Edit' As button":
                        Align: =Align.Left
                        OnSelect: |-
                            =Navigate('TO Request Date Screen', ScreenTransition.Cover, {Edit: ThisItem})
                        Size: =12
                        Text: ="Edit"
                        Width: |
                            ='TO Request Screen Date List Container'.Width * 0.2
                        ZIndex: =4

                    "'TO Date Screen Date List Item Delete' As button":
                        Align: =Align.Left
                        Fill: =RGBA(168, 0, 0, 1)
                        OnSelect: =Remove(RequestDates, ThisItem)
                        Size: =10
                        Text: ="Delete"
                        Width: |
                            ='TO Request Screen Date List Container'.Width * 0.2
                        ZIndex: =5

        "'TO Request Screen Add Date Button' As button":
            Fill: =RGBA(56, 96, 178, .80)
            OnSelect: =Navigate('TO Request Date Screen')
            Text: ="Add Request"
            ZIndex: =4

        "'TO Request Screen Comments Input' As text":
            Default: =""
            FillPortions: =1
            HintText: ="Additional Comments"
            LayoutMinHeight: =200
            Mode: =TextMode.MultiLine
            ZIndex: =5

        "'TO Request Screen Submit Button' As button":
            OnSelect: |-
                =CreateTORequest.Run(User().EntraObjectId, JSON({
                    Reason: 'TO Request Screen Comments Input'.Text,
                    Dates: RequestDates
                }, JSONFormat.Compact));
                Navigate('Success Screen', ScreenTransition.CoverRight, { JSON: JSON({
                    Reason: 'TO Request Screen Comments Input'.Text,
                    Dates: RequestDates
                }, JSONFormat.Compact)});
            Text: ="Submit Request"
            ZIndex: =6

