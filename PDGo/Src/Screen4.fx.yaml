Screen4 As screen:
    OnVisible: |-
        =ClearCollect(barCodes, {Value: Blank(), Type: Blank()  }); Clear(barCodes)

    RectQuickActionBar7 As rectangle:
        Height: =88
        Width: =Parent.Width
        ZIndex: =1

    LblAppName7 As label:
        Align: =Align.Center
        Height: =88
        Size: =27
        Text: ="Check-in"
        Width: =Parent.Width
        ZIndex: =2

    Canvas4 As fluidGrid.fluidGridWithBlankCard:
        BorderThickness: =0
        Height: =Parent.Height - Self.Y
        Width: =Parent.Width
        Y: =RectQuickActionBar7.Y + RectQuickActionBar7.Height
        ZIndex: =3

        DataCard4 As dataCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            BorderThickness: =0
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =Parent.Height - 100
            Width: =Parent.Width
            X: =0
            Y: =0
            ZIndex: =1

            Label3_1 As label:
                FontWeight: =FontWeight.Bold
                Height: =72
                Size: =20
                Text: ="Scan the QR code to check in your Training"
                Width: =597
                X: =26
                Y: =40
                ZIndex: =1

            Label2_3 As label:
                Height: =55
                Size: =21
                Text: ="Don't have a QR code? Contact your trainer."
                Width: =597
                X: =26
                Y: =604
                ZIndex: =3

    Icon5_1 As icon.ArrowLeft:
        Icon: =Icon.ArrowLeft
        OnSelect: =Back();
        Width: =106
        Y: =12
        ZIndex: =4

    "BarcodeReader1 As 'Barcode Reader'":
        BorderFillColor: =RGBA(47, 81, 151, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledContentColor: =RGBA(166, 166, 166, 1)
        DisabledFillColor: =RGBA(244, 244, 244, 1)
        DisplayMode: =DisplayMode.Edit
        FillColor: =RGBA(56, 96, 178, 1)
        Height: =77
        HoverBorderColor: =RGBA(88, 115, 171, 1)
        HoverContentColor: =RGBA(255, 255, 255, 1)
        HoverFillColor: =RGBA(47, 81, 151, 1)
        OnScan: |+
            =If(IsBlank(LookUp(MCLETrainingAttendance, Attendee = Last(BarcodeReader1.Barcodes).Value && MeetingID = TrainingID)),
             
                Patch(MCLETrainingAttendance, Defaults(MCLETrainingAttendance), {Attendee: Last(BarcodeReader1.Barcodes).Value, Time: DateTimeValue(Now()),    Attended: true, TrainingID: MeetingID}),
                Patch(MCLETrainingAttendance, LookUp(MCLETrainingAttendance, Attendee = Last(BarcodeReader1.Barcodes).Value && MeetingID = TrainingID), {Attended: true} ))
               //; Patch(barCodes, Defaults(barCodes), { Type: Last(BarcodeReader1.Barcodes).Type, Value: Last(BarcodeReader1.Barcodes).Value  })
            
        PressedBorderColor: =RGBA(56, 96, 178, 1)
        PressedContentColor: =RGBA(56, 96, 178, 1)
        PressedFillColor: =RGBA(255, 255, 255, 1)
        Text: ="Scan Code"
        TextColor: =RGBA(255, 255, 255, 1)
        Width: =452
        X: =94
        Y: =434
        ZIndex: =5

    Gallery1 As gallery.galleryHorizontal:
        DelayItemLoading: =true
        Items: =barCodes
        LoadingSpinner: =LoadingSpinner.Data
        TemplateSize: =If(Self.Layout = Layout.Horizontal, Min(320, Self.Width - 60), Min(320, Self.Height - 60))
        Y: =561
        ZIndex: =6

        Label5 As label:
            Height: =70
            OnSelect: =Select(Parent)
            Size: =21
            Text: =ThisItem.Value
            Width: =320
            Y: =40
            ZIndex: =1

        Label8 As label:
            Height: =70
            OnSelect: =Select(Parent)
            Size: =21
            Text: =ThisItem.Type
            Width: =320
            Y: =148
            ZIndex: =2

