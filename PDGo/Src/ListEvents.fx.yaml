ListEvents As screen:

    Rectangle4_4 As rectangle:
        Fill: =RGBA(25, 53, 110, 1)
        Width: =640
        ZIndex: =1

    Gallery2 As gallery.variableTemplateHeightGallery:
        DelayItemLoading: =true
        Height: =If(filterIcon, 1036 - filterSectionRectangle.Height, 1036)
        Items: |
            =Filter(Courses, StartsWith(CourseTitle, searchInput.Text) || StartsWith(CourseType, searchInput.Text),
            IsBlank(ComboBox1.Selected.Value) || IsEmpty(ComboBox1.SelectedItems) || CourseFormat.Value in ComboBox1.SelectedItems, 
            IsBlank(statusDropdown.Selected.Value) || IsEmpty(statusDropdown.SelectedItems) || CourseStatus.Value = statusDropdown.Selected.Value
            )
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplateFill: =If(ThisItem.IsSelected, Color.AliceBlue, RGBA(0, 0, 0, 0))
        TemplatePadding: =0
        TemplateSize: =344
        Transition: =Transition.Pop
        Y: =If(filterIcon, 100 + filterSectionRectangle.Height, 100)
        ZIndex: =1

        CourseTypeLabel As label:
            Height: =32
            OnSelect: =Select(Parent)
            Size: =21
            Text: |-
                ="Course Type:         " & ThisItem.CourseType
            Width: =560
            X: =40
            Y: =82
            ZIndex: =1

        CourseTitleLabel As label:
            Height: =32
            OnSelect: =Select(Parent)
            Size: =21
            Text: |-
                ="Course Title:          " & ThisItem.CourseTitle
            Width: =560
            X: =40
            Y: =28
            ZIndex: =2

        CoursePresenterLabel As label:
            Height: =32
            OnSelect: =Select(Parent)
            Size: =21
            Text: |-
                ="Presenter:              " & ThisItem.'Presenter/Panelist'.DisplayName
            Width: =560
            X: =40
            Y: =190
            ZIndex: =3

        CourseDateLabel As label:
            Height: =32
            OnSelect: =Select(Parent)
            Size: =21
            Text: |-
                ="Course Date:         " &"ðŸ“† "& ThisItem.CourseDate
            Width: =560
            X: =40
            Y: =135
            ZIndex: =4

        CourseFormatLabel As button:
            Fill: =Switch(ThisItem.CourseFormat.Value, "Online", Color.LightGreen, "In-person", Color.LightBlue, "Hybrid", Color.DarkSalmon)
            Height: =52
            OnSelect: =Select(Parent)
            Size: =24
            Text: =ThisItem.CourseFormat.Value
            Width: =212
            X: =57
            Y: =252
            ZIndex: =5

        CourseStatusLabel As label:
            Color: =Switch(ThisItem.CourseStatus.Value, "Available", Color.Blue, "Completed", Color.Green, "In-progress", Color.Orange)
            OnSelect: =Select(Parent)
            Size: =21
            Text: =ThisItem.CourseStatus.Value
            Width: =236
            X: =384
            Y: =252
            ZIndex: =6

        separator As rectangle:
            Fill: =RGBA(25, 53, 110, 1)
            Height: =2
            OnSelect: =Select(Parent)
            Width: =538
            X: =40
            Y: =334
            ZIndex: =7

        sideSeparator As rectangle:
            Fill: =RGBA(25, 53, 110, 1)
            Height: =279
            OnSelect: =Select(Parent)
            Width: =5
            X: =23
            Y: =28
            ZIndex: =8

        btnTemplate As button:
            Fill: =Color.Transparent
            Height: =Parent.TemplateHeight
            HoverFill: =ColorFade(Self.Fill, -20%)
            OnSelect: =Select(Parent)
            PressedFill: =ColorFade(Self.Fill, -30%)
            Size: =24
            Text: ="Button"
            Width: =Parent.TemplateWidth
            X: =3
            Y: =9
            ZIndex: =9

    EventsTitle As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Lato
        Height: =74
        Size: =25
        Text: ="Events"
        Width: =112
        X: =81
        Y: =15
        ZIndex: =2

    arrowback As icon.ArrowLeft:
        Color: =RGBA(255, 255, 255, 1)
        Height: =43
        Icon: =Icon.ArrowLeft
        OnSelect: =Navigate(TrainingTrackerHome, ScreenTransition.Cover)
        Width: =48
        X: =22
        Y: =30
        ZIndex: =4

    Icon14 As icon.Search:
        Color: =RGBA(255, 255, 255, 1)
        Height: =52
        Icon: =Icon.Search
        OnSelect: |-
            =UpdateContext({searchIcon: !searchIcon})
        Width: =48
        X: =585
        Y: =26
        ZIndex: =5

    searchInput As text:
        Default: =""
        Height: =58
        HintText: ="Title or Type"
        Size: =21
        Visible: =searchIcon
        Width: =308
        X: =266
        Y: =23
        ZIndex: =6

    Icon15 As icon.Filter:
        Color: =RGBA(255, 255, 255, 1)
        Height: =52
        Icon: =Icon.Filter
        OnSelect: |-
            =UpdateContext({filterIcon: !filterIcon})
        Width: =48
        X: =195
        Y: =29
        ZIndex: =7

    filterSectionRectangle As rectangle:
        Fill: =RGBA(130, 146, 179, 1)
        Height: =312
        Visible: =filterIcon
        Width: =640
        Y: =100
        ZIndex: =8

    Label8 As label:
        Align: =Align.Center
        Size: =21
        Text: ="Status"
        Visible: =filterIcon
        Width: =203
        X: =35
        Y: =110
        ZIndex: =10

    ResetButton As button:
        Fill: =RGBA(25, 53, 110, 1)
        Height: =52
        OnSelect: =Reset(statusDropdown); Clear(colTaskStatusFilter)
        Size: =24
        Text: ="Reset"
        Visible: =filterIcon
        Width: =165
        X: =450
        Y: =168
        ZIndex: =11

    statusDropdown As combobox:
        ChevronBackground: =RGBA(25, 53, 110, 1)
        DisplayFields: =["Value"]
        Height: =60
        IsSearchable: =false
        Items: =Choices(Courses.CourseStatus)
        SearchFields: =["Value"]
        SearchItems: =[]
        SelectionFill: =RGBA(25, 53, 110, 1)
        SelectMultiple: =false
        Size: =21
        Visible: =filterIcon
        Width: =261
        X: =35
        Y: =160
        ZIndex: =12

    Gallery5 As gallery.galleryHorizontal:
        DelayItemLoading: =true
        Height: =109
        Items: =Choices(Courses.CourseFormat)
        LoadingSpinner: =LoadingSpinner.Data
        TemplateSize: =192
        Visible: =filterIcon
        Width: =590
        X: =25
        Y: =273
        ZIndex: =13

        Checkbox1 As checkbox:
            CheckboxSize: =50
            Default: =ThisItem in colTaskStatusFilter
            Height: =85
            OnCheck: =Collect(colTaskStatusFilter, ThisItem)
            OnSelect: =Select(Parent)
            OnUncheck: =Remove(colTaskStatusFilter, ThisItem)
            Size: =19
            Text: =ThisItem.Value
            Width: =192
            ZIndex: =1

    ComboBox1 As combobox:
        ChevronBackground: =RGBA(25, 53, 110, 1)
        DefaultSelectedItems: =colTaskStatusFilter.Value
        DisplayFields: =["Value"]
        Height: =60
        IsSearchable: =false
        Items: =Choices(Courses.CourseFormat)
        SearchFields: =["Value"]
        SearchItems: =[]
        SelectionFill: =RGBA(25, 53, 110, 1)
        Size: =21
        Visible: =false
        Width: =293
        X: =322
        Y: =108
        ZIndex: =14

    CalendarEventsView As groupContainer.manualLayoutContainer:
        Height: =1136
        Width: =640
        ZIndex: =15

        Rectangle4 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =1136
            Width: =640
            ZIndex: =1

        ListEventsOnCalCont_1 As groupContainer.manualLayoutContainer:
            Height: =450
            Width: =Parent.Width
            Y: =686
            ZIndex: =2

            eventsOnCalendar_1 As gallery.variableTemplateHeightGallery:
                DelayItemLoading: =true
                Height: =484
                Items: |-
                    =SortByColumns(
                        Filter(
                            MyCalendarEvents, 
                            Text(Start, DateTimeFormat.ShortDate) = Text(_dateSelected, DateTimeFormat.ShortDate) && StartsWith( Subject , "TRAINING")
                        ), 
                        "Start"
                    )
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplateFill: =If(ThisItem.IsSelected, Color.AliceBlue, RGBA(0, 0, 0, 0))
                TemplatePadding: =0
                TemplateSize: =284
                Transition: =Transition.Pop
                Width: =Parent.Width
                ZIndex: =1

                btnTemplate_3 As button:
                    Color: =
                    Fill: |-
                        =If(
                            "mcle" in Lower(ThisItem.Subject),
                            Color.AliceBlue, 
                            If(
                               "safety" in Lower(ThisItem.Subject),
                               RGBA(0, 0, 255, 1), 
                               RGBA(255, 255, 255, 1) 
                            )
                        )
                    Height: =222
                    HoverFill: =ColorFade(Self.Fill, -20%)
                    OnSelect: =Select(Parent)
                    PressedFill: =ColorFade(Self.Fill, -30%)
                    Size: =24
                    Text: =
                    Width: =Parent.Width
                    ZIndex: =1

                TImeNDate_1 As label:
                    Align: =Align.Center
                    Height: =74
                    OnSelect: =Select(Parent)
                    Size: =21
                    Text: =ThisItem.Start & " - " & ThisItem.End
                    Width: =Parent.Width
                    Y: =51
                    ZIndex: =2

                RSVPNavButtn_1 As button:
                    BorderColor: =ColorFade(Self.Fill, -10%)
                    BorderThickness: =4
                    Color: =RGBA(0, 0, 0, 1)
                    Fill: =RGBA(222, 222, 222, 1)
                    Height: =42
                    OnSelect: =//Navigate(InsertRSVPNameHere, ScreenTransition.Cover)
                    Size: =24
                    Text: ="RSVP"
                    Width: =150
                    X: =(Parent.Width - Self.Width) / 2
                    Y: =125 +Parent.Y
                    ZIndex: =3

                NameOfEvent_1 As label:
                    Align: =Align.Center
                    Height: =46
                    OnSelect: =Select(Parent)
                    Size: =21
                    Text: =ThisItem.Subject
                    Width: =Parent.Width
                    Y: =16
                    ZIndex: =4

                separator_3 As rectangle:
                    Fill: =RGBA(25, 53, 110, 1)
                    Height: =2
                    OnSelect: =Select(Parent)
                    Width: =500
                    Y: =220
                    ZIndex: =5

                sideSeparator_3 As rectangle:
                    Fill: =RGBA(25, 53, 110, 1)
                    Height: =Parent.Height / 3
                    OnSelect: =Select(Parent)
                    Width: =2
                    Y: =28
                    ZIndex: =6

                SelectItemLabel_1 As label:
                    Height: =120
                    OnSelect: =Select(Parent)
                    Size: =21
                    Text: =If(_showLoading, "Loading events...", "No events scheduled")
                    Visible: =IsBlank(_userDomain)
                    Width: =366
                    X: =134
                    Y: =28
                    ZIndex: =8

                Group1_1 As group:
                    Height: =5
                    Width: =5
                    X: =40
                    Y: =40
                    ZIndex: =10

                    LocationLabel_1 As label:
                        Align: =Align.Center
                        Height: =60
                        OnSelect: =Select(Parent)
                        Size: =21
                        Text: =ThisItem.Location
                        Width: =233
                        X: =267
                        Y: =116
                        ZIndex: =7

                    iconLocation3_2 As icon.Waypoint:
                        Color: =RGBA(0, 0, 0, 1)
                        FocusedBorderThickness: =4
                        Height: =50
                        Icon: =Icon.Waypoint
                        OnSelect: =Select(LocationLabel_1)
                        TabIndex: =0
                        Width: =33
                        X: =LocationLabel_1.X
                        Y: =118
                        ZIndex: =9

        Timer1_2 As timer:
            AutoPause: =false
            AutoStart: =true
            DisplayMode: =DisplayMode.View
            Duration: =30000
            Height: =70
            OnTimerEnd: =Clear(MyCalendarEvents)
            Repeat: =true
            Visible: =false
            Width: =280
            X: =220
            Y: =48
            ZIndex: =3

        HeaderCont_2 As groupContainer.manualLayoutContainer:
            Height: =111
            Width: =Parent.Width
            ZIndex: =4

            "'Background Color_14' As rectangle":
                BorderStyle: =BorderStyle.None
                Fill: =RGBA(25, 53, 110, 1)
                Height: =111
                Width: =Parent.Width
                ZIndex: =1

            HeaderTitleLabel_2 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                Font: =Font.Lato
                Height: =111
                Size: =26
                Text: ="Schedule"
                Width: =Parent.Width
                ZIndex: =2

            "'Back Button_11' As icon.ArrowLeft":
                Color: =RGBA(255, 255, 255, 1)
                Height: =43
                Icon: =Icon.ArrowLeft
                OnSelect: =Back( ScreenTransition.Cover)
                Width: =40
                X: =27
                Y: =30
                ZIndex: =3

            Toggle2_2 As toggleSwitch:
                Color: =RGBA(255, 255, 255, 1)
                FalseText: ="List View"
                Height: =51
                OnChange: =Set(isListViewOpen, !isListViewOpen);
                OnCheck: =
                OnSelect: =
                Reset: =true
                Size: =18
                TrueText: ="List View"
                Width: =189
                X: =(Parent.Width - Self.Width) 
                Y: =30
                ZIndex: =5

        CalendarCont_2 As groupContainer.manualLayoutContainer:
            DropShadow: =DropShadow.Regular
            Height: =568
            Width: =Parent.Width
            Y: =118
            ZIndex: =5

            LblMonthSelected3_3 As label:
                Align: =Align.Center
                Font: =Font.Lato
                Height: =64
                Size: =21
                Text: =Text(_firstDayOfMonth, "mmmm yyyy")
                Visible: =!_calendarVisibles
                Width: =Parent.Width
                Wrap: =false
                ZIndex: =1

            iconPrevMonth3_3 As icon.ChevronLeft:
                Icon: =Icon.ChevronLeft
                OnSelect: |-
                    =/*changes month view to previous month*/
                               
                    Set(_firstDayOfMonth, DateAdd(_firstDayOfMonth, -1, TimeUnit.Months));           
                    Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));           
                    Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));           
                    /*collects calendar events for all days in current month view. Updates _minDate to prevent duplicate data collection if user returns to this month view*/           
                    If(_minDate > _firstDayOfMonth,           
                     Collect(MyCalendarEvents, Office365Outlook.GetEventsCalendarViewV2("Calendar", Text(_firstDayInView, DateTimeFormat.UTC), Text(DateAdd(_minDate, -1, TimeUnit.Days), DateTimeFormat.UTC)).value);           
                     Set(_minDate, _firstDayInView))
                PaddingBottom: =10
                PaddingLeft: =10
                PaddingRight: =10
                PaddingTop: =10
                TabIndex: =0
                Tooltip: ="View previous month"
                Visible: =_calendarVisible
                Width: =91
                ZIndex: =2

            iconNextMonth3_3 As icon.ChevronRight:
                Icon: =Icon.ChevronRight
                OnSelect: |-
                    =/*changes month view to next month*/
                               
                    Set(_firstDayOfMonth, DateAdd(_firstDayOfMonth, 1, TimeUnit.Months));           
                    Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));           
                    /*collects calendar events for all days in current month view. Updates _maxDate to prevent duplicate data collection if user returns to this month view*/           
                    Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));           
                    If(_maxDate < _lastDayOfMonth,           
                     Collect(MyCalendarEvents, Office365Outlook.GetEventsCalendarViewV2("Calendar", Text(DateAdd(_maxDate, 1, TimeUnit.Days), DateTimeFormat.UTC), DateAdd(_firstDayInView, 40, TimeUnit.Days)).value);           
                     Set(_maxDate, DateAdd(_firstDayInView, 40, TimeUnit.Days)))
                PaddingBottom: =10
                PaddingLeft: =10
                PaddingRight: =10
                PaddingTop: =10
                TabIndex: =0
                Tooltip: ="View next month"
                Visible: =_calendarVisible
                Width: =91
                X: =Parent.Width - Self.Width
                ZIndex: =3

            RectCalendarEventsHeader3_3 As rectangle:
                Height: =LblCalendarEventsHeader3_3.Height
                Visible: =_calendarVisible
                Width: =LblCalendarEventsHeader3_3.Width
                X: =LblCalendarEventsHeader3_3.X
                Y: =513
                ZIndex: =6

            LblCalendarEventsHeader3_3 As label:
                Align: =Align.Center
                Font: =Font.Lato
                Height: =52
                PaddingLeft: =30
                Size: =21
                Text: =Text(_dateSelected, DateTimeFormat.LongDate)
                Visible: =_calendarVisible
                Width: =Parent.Width
                Wrap: =false
                Y: =513
                ZIndex: =7

            MonthDayGallery3_2 As gallery.MonthDayGallery:
                AccessibleLabel: ="Days of selected month"
                Height: =349
                Items: =[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19, 20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41]
                Layout: =Layout.Vertical
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =65
                Visible: =_calendarVisible
                Width: =Parent.Width
                WrapCount: =7
                Y: =139
                ZIndex: =8

                Circle4_2 As circle:
                    Fill: |-
                        =If(
                            CountRows(Filter(MyCalendarEvents, DateValue(Text(Start)) = DateAdd(_firstDayInView, ThisItem.Value, TimeUnit.Days) && "mcle" in Lower(Subject))) > 0, 
                            Color.Green, 
                            CountRows(Filter(MyCalendarEvents, DateValue(Text(Start)) = DateAdd(_firstDayInView, ThisItem.Value, TimeUnit.Days) && "safety" in Lower(Subject))) > 0,
                            Color.Red, 
                            Color.Black 
                        )
                    Height: =Self.Width
                    OnSelect: =Select(Parent)
                    Visible: |-
                        =CountRows(Filter(MyCalendarEvents, 
                            DateValue(Start) = DateAdd(_firstDayInView, ThisItem.Value, TimeUnit.Days) 
                            && StartsWith(Subject, "Training")
                        )) > 0 && !Subcircle3_2.Visible && Title9_2.Visible
                    Width: =6.5
                    X: =MonthDayGallery3_2.TemplateWidth / 2 - Self.Width / 2
                    Y: =MonthDayGallery3_2.TemplateHeight * (0.75)
                    ZIndex: =1

                Subcircle3_2 As circle:
                    Height: =3 * Title9_2.Size
                    OnSelect: =Select(Parent)
                    Visible: =And(DateAdd(_firstDayInView, ThisItem.Value) = _dateSelected, Title9_2.Visible)
                    Width: =Self.Height
                    X: =MonthDayGallery3_2.TemplateWidth/2 - Self.Width/2
                    Y: =MonthDayGallery3_2.TemplateHeight / 2 - Self.Height / 2
                    ZIndex: =2

                Title9_2 As label:
                    Align: =Align.Center
                    BorderColor: =RGBA(0, 0, 0, 0)
                    Color: =If(DateAdd(_firstDayInView, ThisItem.Value) = _dateSelected, RGBA(255, 255, 255, 1), DateAdd(_firstDayInView, ThisItem.Value) = Today(), RGBA(47, 41, 43, 1), LblMonthSelected3.Color)
                    Fill: |-
                        =/*Fill value changes if the gallery item day = today, or if it lies outside of the current month*/             
                        If(
                            /*Date selected is today*/
                            DateAdd(_firstDayInView, ThisItem.Value) = Today() && DateAdd(_firstDayInView, ThisItem.Value) = _dateSelected, RGBA(0,0,0,0),
                            /*Today when it is not selected*/
                            DateAdd(_firstDayInView, ThisItem.Value) = Today(), ColorFade(Subcircle3_2.Fill, 0.67), 
                            /*The day is outside the range of the currently selected month*/
                            Abs(Self.Text - ThisItem.Value) > 10,RGBA(200, 200, 200, 0.3), RGBA(0, 0, 0, 0))
                    FocusedBorderColor: =Self.Color
                    FocusedBorderThickness: =2
                    Font: =Font.Lato
                    Height: =65
                    OnSelect: =Set(_dateSelected, DateAdd(_firstDayInView, ThisItem.Value, TimeUnit.Days))
                    Size: =17 * MonthDayGallery3_2.TemplateWidth / 91
                    TabIndex: =0
                    Text: =Day(DateAdd(_firstDayInView,ThisItem.Value, TimeUnit.Days))
                    Visible: |-
                        =/*This item is in a row containing no days of the visible month. It is in the row after the row where the last day of the month occurs*/ 
                         !(DateAdd(_firstDayInView,ThisItem.Value, TimeUnit.Days) - Weekday(DateAdd(_firstDayInView,ThisItem.Value, TimeUnit.Days)) + 1 > _lastDayOfMonth)
                    Width: =71.42857142857143
                    Wrap: =false
                    ZIndex: =3

        WeekTitleCont_1 As groupContainer.manualLayoutContainer:
            Height: =47
            Width: =Parent.Width
            Y: =178
            ZIndex: =6

            WeekdayGallery3_4 As gallery.WeekdayGallery:
                AccessibleLabel: ="Days of the week"
                Height: =45
                Items: =Calendar.WeekdaysShort()
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =91
                Visible: =_calendarVisible
                Width: =Parent.Width
                Y: =2
                ZIndex: =1

                Title8_4 As label:
                    Align: =Align.Center
                    Font: =Font.Lato
                    Height: =WeekdayGallery3_4.TemplateHeight
                    OnSelect: =Select(Parent)
                    Size: =17 * WeekdayGallery3_4.TemplateWidth / 77
                    Text: =ThisItem.Value
                    Width: =Parent.Width - 515
                    Wrap: =false
                    Y: =WeekdayGallery3_4.TemplateHeight / 2 - Self.Height / 2
                    ZIndex: =1

